
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="AI4Med">
      
      
      
        <link rel="canonical" href="https://junwei-lu.github.io/ai4med/chapter_generative_model/langevin_dynamics/">
      
      
        <link rel="prev" href="../">
      
      
        <link rel="next" href="../ddpm/">
      
      
      <link rel="icon" href="../../assets/images/favicon-stat.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.44">
    
    
      
        <title>Langevin Dynamics - AI4Med</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.0253249f.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+Sans+SC:300,300i,400,400i,700,700i%7CFira+Code:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Noto Sans SC";--md-code-font:"Fira Code"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
   <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="teal">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#langevin-dynamics" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="AI4Med" class="md-header__button md-logo" aria-label="AI4Med" data-md-component="logo">
      
  <img src="../../assets/images/stat-logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            AI4Med
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Langevin Dynamics
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="teal"  aria-label="Light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M7.5 2c-1.79 1.15-3 3.18-3 5.5s1.21 4.35 3.03 5.5C4.46 13 2 10.54 2 7.5A5.5 5.5 0 0 1 7.5 2m11.57 1.5 1.43 1.43L4.93 20.5 3.5 19.07zm-6.18 2.43L11.41 5 9.97 6l.42-1.7L9 3.24l1.75-.12.58-1.65L12 3.1l1.73.03-1.35 1.13zm-3.3 3.61-1.16-.73-1.12.78.34-1.32-1.09-.83 1.36-.09.45-1.29.51 1.27 1.36.03-1.05.87zM19 13.5a5.5 5.5 0 0 1-5.5 5.5c-1.22 0-2.35-.4-3.26-1.07l7.69-7.69c.67.91 1.07 2.04 1.07 3.26m-4.4 6.58 2.77-1.15-.24 3.35zm4.33-2.7 1.15-2.77 2.2 2.54zm1.15-4.96-1.14-2.78 3.34.24zM9.63 18.93l2.77 1.15-2.53 2.19z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="teal"  aria-label="Light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M7.5 2c-1.79 1.15-3 3.18-3 5.5s1.21 4.35 3.03 5.5C4.46 13 2 10.54 2 7.5A5.5 5.5 0 0 1 7.5 2m11.57 1.5 1.43 1.43L4.93 20.5 3.5 19.07zm-6.18 2.43L11.41 5 9.97 6l.42-1.7L9 3.24l1.75-.12.58-1.65L12 3.1l1.73.03-1.35 1.13zm-3.3 3.61-1.16-.73-1.12.78.34-1.32-1.09-.83 1.36-.09.45-1.29.51 1.27 1.36.03-1.05.87zM19 13.5a5.5 5.5 0 0 1-5.5 5.5c-1.22 0-2.35-.4-3.26-1.07l7.69-7.69c.67.91 1.07 2.04 1.07 3.26m-4.4 6.58 2.77-1.15-.24 3.35zm4.33-2.7 1.15-2.77 2.2 2.54zm1.15-4.96-1.14-2.78 3.34.24zM9.63 18.93l2.77 1.15-2.53 2.19z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="AI4Med" class="md-nav__button md-logo" aria-label="AI4Med" data-md-component="logo">
      
  <img src="../../assets/images/stat-logo.svg" alt="logo">

    </a>
    AI4Med
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Course Information
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Course Information
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_syllabus/index.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    None
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../chapter_preface/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Chapter 0. Introduction
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Chapter 0. Introduction
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Chapter 1. Basics of Coding
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Chapter 1. Basics of Coding
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_coding/index.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    None
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_coding/code_principle.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Principles
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_coding/coding_style.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Code in Style
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../chapter_ai/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Chapter 2. Coding with AI
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Chapter 2. Coding with AI
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_ai/ai_copilot/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AI Copilot
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_ai/prompt_engineering/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Prompt Engineering
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_ai/ai_tools/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AI Tools
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Chapter 3. Computing Workflow
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Chapter 3. Computing Workflow
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_workflow/index.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    None
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_workflow/computing_workflow.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Workflow
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_workflow/git.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Git and GitHub
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_workflow/make.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Make
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_workflow/venv.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Virtual Environment
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_workflow/R.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Reproducible R
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_workflow/docker.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Docker
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Chapter 4. Complexity analysis
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Chapter 4. Complexity analysis
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_computational_complexity/index.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    None
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_computational_complexity/time_complexity.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Time complexity
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_computational_complexity/space_complexity.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Space complexity
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Chapter 5. Data Structures
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Chapter 5. Data Structures
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_data_structures/index.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    None
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_data_structures/list.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lists
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_data_structures/stack.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Stack
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_data_structures/queue.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Queue
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_data_structures/hash_map.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hash Table
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_data_structures/numpy_array.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NumPy Arrays
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_data_structures/pandas_dataframe.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pandas DataFrame
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_data_structures/polars.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Polars
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_data_structures/multiprocess.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multiprocessing
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Chapter 6. Discrete Algorithms
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Chapter 6. Discrete Algorithms
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_algorithms/index.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    None
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_algorithms/climb_stairs.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Depth-first Search
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_algorithms/divide_n_conquer.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Divide and Conquer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_algorithms/bfs.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Breadth-first Search
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_algorithms/dynamic_programming.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dynamic Programming
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_algorithms/summary.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Summary
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Chapter 7. Numerical Linear Algebra
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Chapter 7. Numerical Linear Algebra
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_linear_algebra/index.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    None
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_linear_algebra/basic_linear_algebra.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Linear Algebra Basics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_linear_algebra/numerical_criteria.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Numerical Criteria
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_linear_algebra/linear_equation.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Linear Equations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_linear_algebra/eigen.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Eigen-Decomposition
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_linear_algebra/sparse_matrix.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sparse Matrices
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_linear_algebra/stochastic_matrix.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Randomized Methods
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_linear_algebra/gpu_matrix.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GPU for Matrices
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../chapter_optimization/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Chapter 8. Optimization
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_10" id="__nav_10_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            Chapter 8. Optimization
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_optimization/convexity/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Convexity
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_optimization/rate_of_convergence/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Rate of Convergence
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_optimization/pytorch_basics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PyTorch Basics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_optimization/gradient_descent/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Gradient Descent
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_optimization/agd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Accelerated Gradient Descent
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_optimization/sgd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Stochastic Gradient Descent
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_optimization/proximal_gradient_descent/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Proximal Gradient Descent
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_optimization/mirror_descent/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mirror Descent
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_optimization/nesterov_smooth/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Nesterov's Smooth Method
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_optimization/duality_and_admm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Duality and ADMM
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../chapter_neural_networks/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Chapter 9. Neural Networks
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_11" id="__nav_11_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11">
            <span class="md-nav__icon md-icon"></span>
            Chapter 9. Neural Networks
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_neural_networks/nn/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Neural Networks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_neural_networks/regularization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Regularization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_neural_networks/cnn/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Convolutional Neural Networks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_neural_networks/resnet/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Residual Networks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_neural_networks/fine_tuning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fine-tuning
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_neural_networks/computer_vision/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Computer Vision
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_neural_networks/dl_workflow/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Training Workflow
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_neural_networks/dl_gpu/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PyTorch for GPU
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_neural_networks/dl_tips/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Deep Learning Tips
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_neural_networks/pitfall/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PyTorch Pitfalls
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_12" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../chapter_language_model/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Chapter 10. Language Models
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_12" id="__nav_12_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_12">
            <span class="md-nav__icon md-icon"></span>
            Chapter 10. Language Models
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_language_model/wordvec/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Word Vectors
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_language_model/attention/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Attention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_language_model/transformer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Transformer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_language_model/hg_transformers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hugging Face
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_13" >
        
          
          <label class="md-nav__link" for="__nav_13" id="__nav_13_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Chapter 11. Reinforcement Learning
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_13">
            <span class="md-nav__icon md-icon"></span>
            Chapter 11. Reinforcement Learning
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_reinforcement_learning/index.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    None
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_reinforcement_learning/mdp.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Markov Decision Process
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_reinforcement_learning/policy_grad.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Policy Gradient
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_reinforcement_learning/ppo.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Proximal Policy Optimization
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_14" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Chapter 12. Generative Models
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_14" id="__nav_14_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_14_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_14">
            <span class="md-nav__icon md-icon"></span>
            Chapter 12. Generative Models
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Langevin Dynamics
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Langevin Dynamics
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#from-sampling-to-optimization" class="md-nav__link">
    <span class="md-ellipsis">
      From Sampling to Optimization
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vector-field-of-gradient-flow" class="md-nav__link">
    <span class="md-ellipsis">
      Vector Field of Gradient Flow
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#continuity-equation" class="md-nav__link">
    <span class="md-ellipsis">
      Continuity Equation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gradient-descent-on-the-space-of-densities" class="md-nav__link">
    <span class="md-ellipsis">
      Gradient Descent on the Space of Densities
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sampling-from-the-fokker-planck-equation" class="md-nav__link">
    <span class="md-ellipsis">
      Sampling from the Fokker-Planck Equation
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ddpm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Diffusion Models
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../flow_match/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Flow Matching
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_15" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../chapter_appendix/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Appendix
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_15" id="__nav_15_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_15_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_15">
            <span class="md-nav__icon md-icon"></span>
            Appendix
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_appendix/installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_appendix/github/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Github Classroom
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_appendix/cluster/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Class Cluster
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_appendix/python_intro/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Python 101
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_appendix/contribution/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contributing
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_16" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../chapter_reference/" class="md-nav__link ">
              
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9 3v15h3V3zm3 2 4 13 3-1-4-13zM5 5v13h3V5zM3 19v2h18v-2z"/></svg>
  
  <span class="md-ellipsis">
    References
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_16_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_16">
            <span class="md-nav__icon md-icon"></span>
            References
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#from-sampling-to-optimization" class="md-nav__link">
    <span class="md-ellipsis">
      From Sampling to Optimization
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#vector-field-of-gradient-flow" class="md-nav__link">
    <span class="md-ellipsis">
      Vector Field of Gradient Flow
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#continuity-equation" class="md-nav__link">
    <span class="md-ellipsis">
      Continuity Equation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gradient-descent-on-the-space-of-densities" class="md-nav__link">
    <span class="md-ellipsis">
      Gradient Descent on the Space of Densities
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sampling-from-the-fokker-planck-equation" class="md-nav__link">
    <span class="md-ellipsis">
      Sampling from the Fokker-Planck Equation
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  <!-- Tags -->


<!-- Actions -->
<!-- Actions -->


  <!-- Edit button -->
  

  <!-- View button -->
  


<!-- Page content -->
<h1 id="langevin-dynamics">Langevin Dynamics<a class="headerlink" href="#langevin-dynamics" title="Permanent link">&para;</a></h1>
<p>Our goal is to sample from a target distribution </p>
<div class="arithmatex">\[
p(x) \propto e^{-f(x)} \leftrightarrow  \log p(x) = -f(x) + \text{const}
\]</div>
<p>When <span class="arithmatex">\(f\)</span> is complicated, we cannot sample from <span class="arithmatex">\(p\)</span> directly. It might even be intractable to compute the partition function <span class="arithmatex">\(Z = \int e^{-f(x)} \, dx\)</span>.
We are going to heuristically show you that sampling from <span class="arithmatex">\(p\)</span> is essentially an optimization problem. There will be many gaps in the following derivation. We suggest the reader to read the <a href="https://arxiv.org/pdf/1802.08089">paper</a> for more details.</p>
<h2 id="from-sampling-to-optimization">From Sampling to Optimization<a class="headerlink" href="#from-sampling-to-optimization" title="Permanent link">&para;</a></h2>
<p>For simplicity, we now consider <span class="arithmatex">\(p = e^{-f(x)}\)</span>. 
In order to sample from <span class="arithmatex">\(p\)</span>, our idea is to start with an optimization problem with the minimizer as <span class="arithmatex">\(p\)</span>. One natural choice of the optimization problem is:</p>
<div class="arithmatex">\[
p = \min_{\rho} \text{KL}(\rho \| p) = \int \rho(x) \log \frac{\rho(x)}{p(x)} \, dx
\]</div>
<p>where <span class="arithmatex">\(\text{KL}(\rho \| p)\)</span> quantifies the discrepancy between distributions <span class="arithmatex">\(\rho\)</span> and <span class="arithmatex">\(p\)</span>, and it is called the <strong>Kullback-Leibler (KL) divergence</strong>.</p>
<p>As <span class="arithmatex">\(p = e^{-f(x)}\)</span>, the loss function</p>
<div class="arithmatex">\[
\begin{aligned}
 F(\rho):=\text{KL}(\rho \| p) &amp; = \mathbb{E}_{\rho}[ \log(\rho/q)]  \\
 &amp;= \int \rho(x) \log \frac{\rho(x)}{p(x)} \, dx \\
 &amp;= \int \rho(x) \left( \log \rho(x) - \log p(x) \right) \, dx \\
 &amp;= \mathbb{E}_{\rho}[f] - H(\rho)
\end{aligned}
\]</div>
<p>where <span class="arithmatex">\(H(\rho) = - \int \rho(x) \log \rho(x) \, dx\)</span> is the entropy of <span class="arithmatex">\(\rho\)</span>.</p>
<p>So now our problem is how to minimize <span class="arithmatex">\(F(\rho)\)</span> over the space of distributions which is an infinite-dimensional optimization problem.</p>
<p>To compare to the <a href="../../chapter_optimization/">finite-dimensional optimization</a>, we need to find out the analog of the following concepts:</p>
<ul>
<li>Compared to <span class="arithmatex">\(x_{t+1} = x_t - \epsilon \nabla f(x_t)\)</span>, how to update <span class="arithmatex">\(\rho\)</span></li>
<li>What is the gradient of <span class="arithmatex">\(F(\rho)\)</span>?</li>
</ul>
<p>In the following sections, we will heuristically build the language for the infinite-dimensional optimization for density.</p>
<h2 id="vector-field-of-gradient-flow">Vector Field of Gradient Flow<a class="headerlink" href="#vector-field-of-gradient-flow" title="Permanent link">&para;</a></h2>
<p>We will answer the first question: how to update <span class="arithmatex">\(\rho\)</span>? Recall the gradient descent algorithm for finite-dimensional optimization <span class="arithmatex">\(\min_{x} f(x)\)</span> is given by:</p>
<div class="arithmatex">\[
x_{t+1} = x_t - \epsilon g(x_t),
\]</div>
<p>where <span class="arithmatex">\(g(x) = \nabla f(x)\)</span>.</p>
<p>To make an analogy, our idea is to first consider the infinitesimal case with <span class="arithmatex">\(\epsilon \to 0\)</span>, working in the continuous-time domain, and then discretize the continuous-time dynamics to get the discrete-time update.</p>
<p>As <span class="arithmatex">\(\epsilon \to 0\)</span>, the discrete update can be rewritten as a differential equation:</p>
<div class="arithmatex">\[
\frac{x_{t+\epsilon} - x_t}{\epsilon} = -g(x_t)
\]</div>
<p>Taking the limit as <span class="arithmatex">\(\epsilon \to 0\)</span>, we get the continuous-time differential equation:</p>
<div class="arithmatex">\[
\frac{dx(t)}{dt} = -g(x(t))
\]</div>
<p>This ordinary differential equation (ODE) describes how a finite-dimensional point <span class="arithmatex">\(x(t)\)</span> moves along the negative gradient direction of <span class="arithmatex">\(f(x)\)</span>. Thus we also call this <strong>gradient flow</strong>. In general, if we have a vector-valued function <span class="arithmatex">\(v(x)\)</span> defined on any point <span class="arithmatex">\(x\)</span> in the space (e.g., <span class="arithmatex">\(v(x) = -g(x)\)</span> for the gradient flow), we call it a <strong>vector field</strong>, namely any point <span class="arithmatex">\(x\)</span> in the space has a corresponding vector <span class="arithmatex">\(v(x)\)</span>. In general, the vector field can be written as:</p>
<div class="arithmatex">\[
\frac{dx(t)}{dt} = v(x(t))
\]</div>
<p><a class="glightbox" href="../generative.assets/vec_field.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="vector field" src="../generative.assets/vec_field.png" /></a></p>
<p>Now we want to consider the infinite-dimensional case. As <span class="arithmatex">\(\rho\)</span> is a density of <span class="arithmatex">\(x\)</span>, imagine that each <span class="arithmatex">\(x\)</span> is a particle moving along the vector field <span class="arithmatex">\(v(x)\)</span>, following the differential equation above. We aim to answer the key question: How the density <span class="arithmatex">\(\rho(x)\)</span> evolves as <span class="arithmatex">\(\rho(x,t)\)</span> when every of its sample <span class="arithmatex">\(x(t)\)</span> is moving along the vector field <span class="arithmatex">\(v(x)\)</span>?</p>
<p><a class="glightbox" href="../generative.assets/density_evolve.gif" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="vector field" src="../generative.assets/density_evolve.gif" /></a></p>
<h2 id="continuity-equation">Continuity Equation<a class="headerlink" href="#continuity-equation" title="Permanent link">&para;</a></h2>
<p>Our encourage to build the picture of the evolution of <span class="arithmatex">\(\rho(x,t)\)</span> as the fluid flow.
We are going to use the <strong>law of mass conservation</strong> to derive the evolution of <span class="arithmatex">\(\rho(x,t)\)</span>.</p>
<p><a class="glightbox" href="../generative.assets/continuity_eq.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="continuity equation" src="../generative.assets/continuity_eq.png" /></a></p>
<p>We consider an infinitesimally small box with volume <span class="arithmatex">\(\Delta x \Delta y\)</span> in the space. The mass of fluid in the box is <span class="arithmatex">\(\rho(x,y,t) \Delta x \Delta y\)</span>. </p>
<p>When time evolves from <span class="arithmatex">\(t\)</span> to <span class="arithmatex">\(t+\Delta t\)</span>, we have the <strong>law of mass conservation</strong>:</p>
<blockquote>
<p>Mass changed in the box = Net mass flowed in the boundary</p>
</blockquote>
<p>We are going to compute both sides of the above equation.</p>
<div class="arithmatex">\[
\text{Mass changed in the box} =(\rho(x,y,t+\Delta t) - \rho(x,y,t)) \Delta x \Delta y
\]</div>
<p>For the right hand side, recalling that the vector field <span class="arithmatex">\(v(x,y)\)</span> is a two-dimensional vector <span class="arithmatex">\((v_x, v_y)\)</span>, without loss of generality, we assume <span class="arithmatex">\(v\)</span> points to the upper right corner of the box. Namely: the mass flowed in on the left and bottom boundaries, and flowed out on the right and top boundaries, i.e., Net mass flowed in the boundary = Mass flowed in - Mass flowed out.</p>
<div class="arithmatex">\[
\begin{align*}
\text{Mass flowed in} = &amp;v_x(x,y) \rho(x,y,t) \Delta y \Delta t\\
&amp; + v_y(x,y) \rho(x,y,t) \Delta x \Delta t \\
\text{Mass flowed out} = &amp;v_x(x+\Delta x,y) \rho(x+\Delta x,y,t) \Delta y \Delta t \\
&amp; + v_y(x,y+\Delta y) \rho(x,y+\Delta y,t) \Delta x \Delta t
\end{align*}
\]</div>
<p>The net increase of mass flowed in the boundary is:</p>
<div class="arithmatex">\[
\begin{align*}
 &amp;- \left[\left( v_x(x+\Delta x,y)\rho(x+\Delta x,y,t) -v_x(x,y)\rho(x,y,t)  \right)  \Delta y  \right. \\
 &amp; \qquad \left. + \left(v_y(x,y+\Delta y)\rho(x,y+\Delta y,t) - v_y(x,y)\rho(x,y,t) \right) \Delta x \right]\Delta t \\
= &amp;- \left[\frac{\left( v_x(x+\Delta x,y)\rho(x+\Delta x,y,t) -v_x(x,y)\rho(x,y,t)  \right)}{\Delta x} \right. \\
&amp; \qquad \left. + \frac{\left(v_y(x,y+\Delta y)\rho(x,y+\Delta y,t) - v_y(x,y)\rho(x,y,t) \right)}{\Delta y}\right]\Delta t \Delta x \Delta y
\end{align*}
\]</div>
<p>Now we combine the two sides of the mass conservation equation together:</p>
<div class="arithmatex">\[
\begin{align*}
\frac{\rho(x,y,t+\Delta t) - \rho(x,y,t)}{\Delta t} = &amp;- \left[\frac{\left( v_x(x+\Delta x,y) \rho(x+\Delta x,y,t) -v_x(x,y) \rho(x,y,t)  \right)}{\Delta x} \right. \\
&amp; \qquad \left. + \frac{\left(v_y(x,y+\Delta y) \rho(x,y+\Delta y,t) - v_y(x,y) \rho(x,y,t) \right)}{\Delta y}\right]
\end{align*}
\]</div>
<p>Let all the infinitesimal quantities <span class="arithmatex">\(\Delta x, \Delta y, \Delta t\)</span> go to zero, we get the <strong>continuity equation</strong>:</p>
<div class="arithmatex">\[
\frac{\partial \rho(x,y,t)}{\partial t} = - \frac{\partial}{\partial x} \left( v_x(x,y) \rho(x,y,t) \right) - \frac{\partial}{\partial y} \left( v_y(x,y) \rho(x,y,t) \right)
\]</div>
<p>Now we want to simplify the notation above to make math more elegant. We will treat the gradient operator as a vector  <span class="arithmatex">\(\nabla = (\partial_x, \partial_y)\)</span>, then we define the divergence of a vector field <span class="arithmatex">\(v = (v_x, v_y)\)</span> as</p>
<div class="arithmatex">\[
\nabla \cdot v= \partial_x v_x(x,y) + \partial_y v_y(x,y),
\]</div>
<p>where we abuse the inner product notation <span class="arithmatex">\(a \cdot b = a_1 b_1 + a_2 b_2\)</span> for vectors <span class="arithmatex">\(a, b \in \mathbb{R}^2\)</span>.</p>
<p>Then the above equation can be rewritten as:</p>
<div class="arithmatex">\[
\frac{\partial \rho}{\partial t} = - \nabla \cdot (v \rho)
\]</div>
<p>This equation is true for all dimensions.</p>
<div class="admonition note">
<p class="admonition-title">Continuity Equation for Vector Field</p>
<p>Given a density <span class="arithmatex">\(\rho\)</span> and a velocity field <span class="arithmatex">\(v\)</span>, we suppose each particle <span class="arithmatex">\(x\)</span> moves along the velocity field <span class="arithmatex">\(v(x)\)</span>. Let <span class="arithmatex">\(\rho(x,t)\)</span> be the density of <span class="arithmatex">\(x(t)\)</span>. Then <span class="arithmatex">\(\rho(x,t)\)</span> evolves following the continuity equation:</p>
<div class="arithmatex">\[
\frac{\partial \rho}{\partial t} = - \nabla \cdot (v \rho)
\]</div>
</div>
<p>This answer the first question on how to generalize the gradient descent to the infinite-dimensional case: If we have a descent direction <span class="arithmatex">\(v\)</span>, then the density <span class="arithmatex">\(\rho\)</span> evolves following the continuity equation.</p>
<h2 id="gradient-descent-on-the-space-of-densities">Gradient Descent on the Space of Densities<a class="headerlink" href="#gradient-descent-on-the-space-of-densities" title="Permanent link">&para;</a></h2>
<p>Now we are ready to answer the second question: what is the gradient of <span class="arithmatex">\(F(\rho)\)</span>?</p>
<p>First, we need to specify what do we mean  by the gradient of <span class="arithmatex">\(F(\rho)\)</span> denoted as <span class="arithmatex">\(\text{grad}_{\rho}F\)</span>. By the continuity equation, we aim to find the right vector field <span class="arithmatex">\(v\)</span> to minimize <span class="arithmatex">\(F(\rho)\)</span>. Thus <span class="arithmatex">\(\text{grad}_{\rho}F\)</span> should be a vector field.</p>
<p>Let us first recall the finite-dimensional case. Given a function <span class="arithmatex">\(f(x)\)</span>, how can we "rediscover" the concept of gradient? One way is to consider the time derivative of <span class="arithmatex">\(f(x(t))\)</span> along the trajectory <span class="arithmatex">\(x(t)\)</span>:</p>
<div class="arithmatex">\[
\frac{d}{dt} f(x(t)) = \left\langle \nabla f, \frac{dx}{dt} \right\rangle
\]</div>
<p>This means if a vector <span class="arithmatex">\(g\)</span> satisfies </p>
<div class="arithmatex">\[
\left\langle g, \frac{dx}{dt} \right\rangle = \frac{d}{dt} f(x(t))
\]</div>
<p>then <span class="arithmatex">\(g\)</span> is the gradient of <span class="arithmatex">\(f\)</span>.</p>
<p>In the infinite-dimensional case, the inner product is replaced by the integral:</p>
<div class="arithmatex">\[
\langle f, g \rangle_{\rho} = \mathbb{E}_{\rho}[fg] = \int f(x) g(x)  \rho(x) \, dx
\]</div>
<p>Therefore, heuristically, the gradient of <span class="arithmatex">\(F(\rho)\)</span> should satisfy:</p>
<div class="arithmatex">\[
\frac{d}{dt} F(\rho) = \left\langle \text{grad}_{\rho}F, \frac{d\rho}{dt} \right\rangle_{\rho} \tag{1}
\]</div>
<p>We now start from the left hand side. Recalling the chain rule for finite-dimensional functions, if we have a function <span class="arithmatex">\(f(x(t))\)</span> for a vector <span class="arithmatex">\(x(t)\)</span>, then the time derivative of <span class="arithmatex">\(f\)</span> is given by:</p>
<div class="arithmatex">\[
\frac{d}{dt} f(x(t)) = \left\langle \nabla f(x), \frac{dx}{dt} \right\rangle
\]</div>
<p>The chain rule for the infinite-dimensional  <span class="arithmatex">\(\rho\)</span> changes the inner product to integration:</p>
<div class="arithmatex">\[
\frac{d}{dt} F(\rho) = \int \frac{\delta F}{\delta \rho} \frac{d\rho}{dt} \, dx
\]</div>
<p>where <span class="arithmatex">\(\frac{\delta F}{\delta \rho}\)</span> is the functional derivative of <span class="arithmatex">\(F\)</span> with respect to <span class="arithmatex">\(\rho\)</span>. 
Plugging in the continuity equation
<span class="arithmatex">\(\frac{d\rho}{dt} = - \nabla \cdot (v \rho)\)</span> to the above equation, we get:</p>
<div class="arithmatex">\[
\begin{align*}
\frac{d}{dt} F(\rho) &amp;= \int \frac{\delta F}{\delta \rho} \frac{d\rho}{dt} \, dx\\
&amp;= \int \frac{\delta F}{\delta \rho} \left( - \nabla \cdot (v \rho) \right) \, dx \\
&amp;=  \int \left( \nabla  \frac{\delta F}{\delta \rho} \right) v \rho  \, dx\\
&amp;= \left\langle \nabla \frac{\delta F}{\delta \rho}, v \right\rangle_{\rho}, \tag{2}
\end{align*} 
\]</div>
<p>where we apply the integration by parts in the third line:</p>
<div class="arithmatex">\[
\int f \nabla g \, dx = - \int \nabla f \cdot g \, dx + f g |_{-\infty}^{\infty} = - \int \nabla f \cdot g \, dx
\]</div>
<p>if <span class="arithmatex">\(f, g\)</span> vanish at the infinity. (Note that we abuse a lot of notations here. Please see the <a href="https://arxiv.org/pdf/1802.08089">paper</a> for rigorous derivation.)</p>
<p>Therefore, by comparing (1) and (2), we have:</p>
<div class="arithmatex">\[
\text{grad}_{\rho}F = \nabla \frac{\delta F}{\delta \rho}
\]</div>
<p>We are going to practice our infinite-dimensional calculus now. To compute <span class="arithmatex">\(\frac{\delta F}{\delta \rho}\)</span>, you can pretend that <span class="arithmatex">\(\rho\)</span> is a "variable" and <span class="arithmatex">\(F\)</span> is a "function" of <span class="arithmatex">\(\rho\)</span>. When taking the functional derivative, just taking the derivative of the integrand with respect to <span class="arithmatex">\(\rho\)</span>. Let us start with the simplest case of linear functional, i.e., <span class="arithmatex">\(L(\rho) = \int f(x) \rho(x) \, dx\)</span>. Then </p>
<div class="arithmatex">\[
\frac{\delta L }{\delta \rho} = f \text{ and }\text{grad}_{\rho} L = \nabla \frac{\delta L}{\delta \rho} = \nabla f
\]</div>
<p>Now let us try a more complicated case of  entropy functional, <span class="arithmatex">\(H(\rho) = - \int \rho \log \rho \, dx\)</span>. </p>
<div class="arithmatex">\[
\frac{\delta H }{\delta \rho} = -\log \rho - 1 \text{ and }\text{grad}_{\rho} H = \nabla \frac{\delta H}{\delta \rho} = \nabla (-\log \rho - 1) = - \frac{\nabla \rho}{\rho}
\]</div>
<p>Therefore, the gradient of our functional loss
<span class="arithmatex">\(F(\rho) = \int f(x) \rho(x) \, dx - H(\rho)\)</span> is given by:</p>
<div class="arithmatex">\[
\text{grad}_{\rho}F = \nabla \frac{\delta F}{\delta \rho} = \nabla f + \frac{\nabla \rho}{\rho}
\]</div>
<p>Thus we have answered the second question on the analog of the gradient  for the infinite-dimensional  loss function <span class="arithmatex">\(F(\rho)\)</span>.</p>
<p>Plugging in the negative gradient <span class="arithmatex">\(-\text{grad}_{\rho}F\)</span> as the vector field <span class="arithmatex">\(v\)</span> into the continuity equation, we get the <strong>Fokker-Planck equation</strong>:</p>
<div class="arithmatex">\[
\begin{align*}
\frac{\partial \rho}{\partial t} &amp;= - \nabla \cdot (\rho \cdot -\text{grad}_{\rho}F  ) \\
&amp;= - \nabla \cdot \left( \rho \cdot \left( \nabla f - \frac{\nabla \rho}{\rho} \right) \right)\\
&amp; = - \nabla \cdot( \rho \nabla f) + \Delta \rho 
\end{align*}
\]</div>
<p>where the last equation is due to <span class="arithmatex">\(\nabla \cdot \nabla = \Delta\)</span>, where <span class="arithmatex">\(\Delta\)</span> is the Laplacian operator <span class="arithmatex">\(\Delta f =  \sum_{i=1}^d \frac{\partial^2 f}{\partial x_i^2}\)</span>.</p>
<p>Therefore, we have the following "gradient algorithm" for our loss function <span class="arithmatex">\(F(\rho)\)</span>:</p>
<div class="admonition note">
<p class="admonition-title">Fokker-Planck Equation for Gradient Flow</p>
<p>Let <span class="arithmatex">\(p = e^{-f}\)</span> be the target distribution. The gradient algorithm for <span class="arithmatex">\(\min_\rho \text{KL}(\rho \| p)\)</span> is equivalent to the Fokker-Planck equation:</p>
<div class="arithmatex">\[
\frac{\partial \rho}{\partial t} = - \nabla \cdot( \rho \nabla f) + \Delta \rho
\]</div>
</div>
<p>Mathematicians will be angry about our derivation above. Our derivation above is totally heuristic though we get the correct answer. However, we will defend ourself by the following quote:</p>
<div class="admonition quote">
<p class="admonition-title">An anonymous bad statistician:</p>
<p>A bad statistician makes odd number of mistakes. A good statistician makes even number of mistakes.</p>
</div>
<h2 id="sampling-from-the-fokker-planck-equation">Sampling from the Fokker-Planck Equation<a class="headerlink" href="#sampling-from-the-fokker-planck-equation" title="Permanent link">&para;</a></h2>
<p>You might have forgotten why we are here. Let me remind you: we want to sample from the target distribution <span class="arithmatex">\(p = e^{-f}\)</span> by solving the optimization problem <span class="arithmatex">\(\min_\rho \text{KL}(\rho \| p)\)</span>. Our verbose derivation above is to show that the gradient descent analogy solving this problem is equivalent to the evolution of the density <span class="arithmatex">\(\rho\)</span> following the Fokker-Planck equation.</p>
<p>But how could we use the Fokker-Planck equation to sample from <span class="arithmatex">\(p\)</span>? Recalling the continuity equation, the evolution of <span class="arithmatex">\(\rho\)</span> following the continuity equation <span class="arithmatex">\(\frac{\partial \rho}{\partial t} = - \nabla \cdot( \rho v)\)</span> is equivalent to the movement of particles following the vector field <span class="arithmatex">\(v\)</span>.</p>
<p>That means if the density <span class="arithmatex">\(\rho\)</span> evolves following</p>
<div class="arithmatex">\[
\frac{\partial \rho}{\partial t} = - \nabla \cdot( \rho \nabla f),
\]</div>
<p>then the movement of particles <span class="arithmatex">\(x(t)\)</span> will follow the vector field  <span class="arithmatex">\(- \nabla f(x)\)</span>, namely </p>
<div class="arithmatex">\[
x_{t+1} = x_t - \epsilon \nabla f(x_t).
\]</div>
<p>This is exactly the gradient descent algorithm.</p>
<p>However, the Fokker-Planck equation has two terms on the right hand side:  <span class="arithmatex">\(- \nabla \cdot( \rho \nabla f)\)</span> which gives the gradient descent, and <span class="arithmatex">\(\Delta \rho\)</span> which we will discuss now.</p>
<p>As the continuity equation considers the first term, we now consider the equation with only the Laplacian term on the right hand side:</p>
<div class="arithmatex">\[
\frac{\partial \rho}{\partial t} =  \Delta \rho
\]</div>
<p>This is the famous <strong>heat equation</strong> which you can check that the Gaussian distribution below is the solution:</p>
<div class="arithmatex">\[
\rho(x,t) = \frac{1}{(4\pi t)^{d/2}} e^{-\frac{|x|^2}{4t}}, \text{ i.e., } x \sim \mathcal{N}(0,2t)
\]</div>
<p>In fact, the solution of the heat equation cannot be unique without the  initial condition at time <span class="arithmatex">\(t=0\)</span>, i.e., <span class="arithmatex">\(\rho(x,0)\)</span>. We have the following heat equation solution:</p>
<div class="admonition note">
<p class="admonition-title">Heat Equation Solution</p>
<p>The solution of the heat equation</p>
<div class="arithmatex">\[
\frac{\partial \rho}{\partial t} =  \Delta \rho, \quad \rho(x,0) = \rho_0(x)
\]</div>
<p>is given by the density of adding <span class="arithmatex">\(X_0 \sim \rho_0\)</span> with Gaussian noise:</p>
<div class="arithmatex">\[
X_t = X_0 + \sqrt{2t} \xi, \quad \xi \sim \mathcal{N}(0,I).
\]</div>
<p>Namely, the solution <span class="arithmatex">\(\rho(x,t)\)</span> as the density of <span class="arithmatex">\(X_t\)</span> is the convolution of the initial density <span class="arithmatex">\(\rho_0\)</span> with the Gaussian distribution:</p>
<div class="arithmatex">\[
\rho(x,t) = \int \rho_0(y) \frac{1}{(4\pi t)^{d/2}} e^{-\frac{|x-y|^2}{4t}} \, dy.
\]</div>
</div>
<p><a class="glightbox" href="../generative.assets/Heat_smiley-crop.gif" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Heat Equation" src="../generative.assets/Heat_smiley-crop.gif" /></a>
You can check that the solution of the heat equation by plugging in the solution into the heat equation. We can see how the density changes over time under the heat equation in the animation above. You can see that the heat equation is called the <strong>diffusion</strong> equation as it smooths out the density over time.</p>
<p>We can discretize <span class="arithmatex">\(X_t = X_0 + \sqrt{2t} \xi\)</span> as an iterative process:</p>
<div class="arithmatex">\[
X_{t+1} = X_t + \sqrt{2\epsilon} \xi_t, \quad \xi_t \sim \mathcal{N}(0,I).
\]</div>
<p>Now we have the good intuition on the two terms in the Fokker-Planck equation (3). The first term <span class="arithmatex">\(- \nabla \cdot( \rho \nabla f)\)</span> gives the gradient descent, and the second term <span class="arithmatex">\(\Delta \rho\)</span> add the Gaussian noise. </p>
<p>Let's summarize the relationship between the Fokker-Planck equation and Langevin dynamics with the following diagram:</p>
<div class="arithmatex">\[
\begin{array}{ccccl}
\text{Density Evolution} &amp; \xrightarrow{\text{Fokker-Planck}} &amp; \frac{\partial \rho}{\partial t} =&amp; -\nabla \cdot(\rho \nabla f) &amp; + \Delta \rho \\
\updownarrow \text{vector field}&amp; &amp;  &amp; \updownarrow \text{drift}&amp; \updownarrow \text{diffusion}\\
\text{Particle Movement} &amp; \xrightarrow{\text{Langevin}} &amp; dX_t =&amp; -\nabla f(X_t) dt &amp; + \sqrt{2} dW_t
\end{array}
\]</div>
<p>Here <span class="arithmatex">\(dW_t\)</span> is the Wiener process which you can think it as <span class="arithmatex">\(\epsilon \xi_t\)</span> with <span class="arithmatex">\(\epsilon \to 0\)</span>.</p>
<p>The top row represents how the probability density <span class="arithmatex">\(\rho\)</span> evolves over time according to the Fokker-Planck equation, while the bottom row shows how individual particles move according to Langevin dynamics. These two perspectives are equivalent: the Fokker-Planck equation describes the collective behavior of particles following Langevin dynamics.</p>
<p>This duality gives us a powerful insight: we can sample from a complex distribution by simulating the movement of particles, rather than directly manipulating the density function.</p>
<p>Therefore, we can sample from the target distribution <span class="arithmatex">\(p\)</span> by translating the Fokker-Planck equation to the particle movement:</p>
<div class="admonition note">
<p class="admonition-title">Langevin Dynamics</p>
<p>The Fokker-Planck equation </p>
<div class="arithmatex">\[
\frac{\partial \rho}{\partial t} =  - \nabla \cdot( \rho \nabla f) + \Delta \rho
\]</div>
<p>is equivalent to the <strong>Langevin dynamics</strong>:</p>
<div class="arithmatex">\[
\frac{dX_t}{dt} = - \nabla f(X_t) + \sqrt{2} \xi_t, \quad \xi_t \sim \mathcal{N}(0,I)
\]</div>
<p>which can be discretized as:</p>
<div class="arithmatex">\[
X_{t+1} = X_t - \epsilon \nabla f(X_t) + \sqrt{2\epsilon} \xi_t, \quad \xi_t \sim \mathcal{N}(0,I),
\]</div>
<p>where <span class="arithmatex">\(\epsilon\)</span> is the step size.</p>
</div>
<p>The above theory shows the connection between the sampling and the optimization:</p>
<div class="admonition note">
<p class="admonition-title">Langevin Dynamics Sampling</p>
<p>We can sample the target distribution <span class="arithmatex">\(p = e^{-f}\)</span> by running the Langevin dynamics:</p>
<div class="arithmatex">\[
X_{t+1} = X_t - \epsilon \nabla f(X_t) + \sqrt{2\epsilon} \xi_t, \quad \xi_t \sim \mathcal{N}(0,I),
\]</div>
<p>The distribution of <span class="arithmatex">\(X_t\)</span> converges to the target distribution <span class="arithmatex">\(p\)</span> as <span class="arithmatex">\(\epsilon \to 0\)</span> and <span class="arithmatex">\(t \to \infty\)</span>.</p>
</div>
<p>You can see the convergence of the Langevin dynamics to the target distribution in the animation below:</p>
<p><a class="glightbox" href="../generative.assets/langevin.gif" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Langevin Dynamics" src="../generative.assets/langevin.gif" /></a></p>
<p>Selecting an appropriate step size <span class="arithmatex">\(\epsilon\)</span> is crucial and presents similar challenges to determining the optimal learning rate in gradient descent. When <span class="arithmatex">\(\epsilon\)</span> is excessively large, we introduce too much noise per iteration, causing the chain to rapidly converge to a stationary distribution that significantly deviates from our target distribution. Conversely, if <span class="arithmatex">\(\epsilon\)</span> is too small, the samples will require an impractically long time to evolve from their starting positions, making the sampling process inefficient.</p>
<p><a class="glightbox" href="../generative.assets/bad_langevin.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="bad sampling" src="../generative.assets/bad_langevin.png" /></a></p>
<p>One way to have a robust way to sample using Langevin dynamics insensitive to the choice of step size <span class="arithmatex">\(\epsilon\)</span> is to use the <strong>Metropolis-adjusted Langevin algorithm</strong> (MALA). We will not go into the details of MALA here. You can refer to the <a href="https://projecteuclid.org/journals/bernoulli/volume-2/issue-4/Exponential-convergence-of-Langevin-distributions-and-their-discrete-approximations/bj/1178291835.full">paper</a> for more details.</p>

<!-- Source file information -->


<!-- Was this page helpful? -->




<!-- Previous and next pages link -->
<nav
class="md-footer__inner md-grid"
aria-label="Footer"

>

<!-- Link to previous page -->

  
  <a
    href="../"
    class="md-footer__link md-footer__link--prev"
    aria-label="Previous: Overview"
    rel="prev"
  >
    <div class="md-footer__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
    </div>
    <div class="md-footer__title">
      <span class="md-footer__direction">
        Previous
      </span>
      <div class="md-ellipsis">
        Overview
      </div>
    </div>
  </a>


<!-- Link to next page -->

  
  <a
    href="../ddpm/"
    class="md-footer__link md-footer__link--next"
    aria-label="Next: Diffusion Models"
    rel="next"
  >
    <div class="md-footer__title">
      <span class="md-footer__direction">
        Next
      </span>
      <div class="md-ellipsis">
        Diffusion Models
      </div>
    </div>
    <div class="md-footer__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
    </div>
  </a>

</nav>

<!-- Comment system -->

                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../" class="md-footer__link md-footer__link--prev" aria-label="Previous: Overview">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Overview
              </div>
            </div>
          </a>
        
        
          
          <a href="../ddpm/" class="md-footer__link md-footer__link--next" aria-label="Next: Diffusion Models">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Diffusion Models
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Junwei Lu, Department of Biostatistics, Harvard T.H. Chan School of Public Health.
    </div>
  
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/junwei-lu/" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://junwei-lu.github.io/" target="_blank" rel="noopener" title="junwei-lu.github.io" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M392.8 1.2c-17-4.9-34.7 5-39.6 22l-128 448c-4.9 17 5 34.7 22 39.6s34.7-5 39.6-22l128-448c4.9-17-5-34.7-22-39.6m80.6 120.1c-12.5 12.5-12.5 32.8 0 45.3l89.3 89.4-89.4 89.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l112-112c12.5-12.5 12.5-32.8 0-45.3l-112-112c-12.5-12.5-32.8-12.5-45.3 0zm-306.7 0c-12.5-12.5-32.8-12.5-45.3 0l-112 112c-12.5 12.5-12.5 32.8 0 45.3l112 112c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L77.3 256l89.4-89.4c12.5-12.5 12.5-32.8 0-45.3"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["announce.dismiss", "content.code.annotate", "content.code.copy", "content.tabs.link", "content.tooltips", "navigation.indexes", "navigation.top", "navigation.footer", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.83f73b43.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.min.js"></script>
      
    
  <script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": false, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "none"});})</script></body>
</html>