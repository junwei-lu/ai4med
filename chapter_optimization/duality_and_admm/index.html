
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="AI4Med">
      
      
      
        <link rel="canonical" href="https://junwei-lu.github.io/ai4med/chapter_optimization/duality_and_admm/">
      
      
        <link rel="prev" href="../nesterov_smooth/">
      
      
        <link rel="next" href="../../chapter_neural_networks/">
      
      
      <link rel="icon" href="../../assets/images/favicon-stat.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.44">
    
    
      
        <title>Duality and ADMM - AI4Med</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.0253249f.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+Sans+SC:300,300i,400,400i,700,700i%7CFira+Code:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Noto Sans SC";--md-code-font:"Fira Code"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
   <link href="../../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }
    .gscrollbar-fixer { padding-right: 15px; }
    .gdesc-inner { font-size: 0.75rem; }
    body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
    body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
    body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}</style> <script src="../../assets/javascripts/glightbox.min.js"></script></head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="teal">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#duality-and-admm" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="AI4Med" class="md-header__button md-logo" aria-label="AI4Med" data-md-component="logo">
      
  <img src="../../assets/images/stat-logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            AI4Med
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Duality and ADMM
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="teal"  aria-label="Light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M7.5 2c-1.79 1.15-3 3.18-3 5.5s1.21 4.35 3.03 5.5C4.46 13 2 10.54 2 7.5A5.5 5.5 0 0 1 7.5 2m11.57 1.5 1.43 1.43L4.93 20.5 3.5 19.07zm-6.18 2.43L11.41 5 9.97 6l.42-1.7L9 3.24l1.75-.12.58-1.65L12 3.1l1.73.03-1.35 1.13zm-3.3 3.61-1.16-.73-1.12.78.34-1.32-1.09-.83 1.36-.09.45-1.29.51 1.27 1.36.03-1.05.87zM19 13.5a5.5 5.5 0 0 1-5.5 5.5c-1.22 0-2.35-.4-3.26-1.07l7.69-7.69c.67.91 1.07 2.04 1.07 3.26m-4.4 6.58 2.77-1.15-.24 3.35zm4.33-2.7 1.15-2.77 2.2 2.54zm1.15-4.96-1.14-2.78 3.34.24zM9.63 18.93l2.77 1.15-2.53 2.19z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="teal"  aria-label="Light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M7.5 2c-1.79 1.15-3 3.18-3 5.5s1.21 4.35 3.03 5.5C4.46 13 2 10.54 2 7.5A5.5 5.5 0 0 1 7.5 2m11.57 1.5 1.43 1.43L4.93 20.5 3.5 19.07zm-6.18 2.43L11.41 5 9.97 6l.42-1.7L9 3.24l1.75-.12.58-1.65L12 3.1l1.73.03-1.35 1.13zm-3.3 3.61-1.16-.73-1.12.78.34-1.32-1.09-.83 1.36-.09.45-1.29.51 1.27 1.36.03-1.05.87zM19 13.5a5.5 5.5 0 0 1-5.5 5.5c-1.22 0-2.35-.4-3.26-1.07l7.69-7.69c.67.91 1.07 2.04 1.07 3.26m-4.4 6.58 2.77-1.15-.24 3.35zm4.33-2.7 1.15-2.77 2.2 2.54zm1.15-4.96-1.14-2.78 3.34.24zM9.63 18.93l2.77 1.15-2.53 2.19z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="AI4Med" class="md-nav__button md-logo" aria-label="AI4Med" data-md-component="logo">
      
  <img src="../../assets/images/stat-logo.svg" alt="logo">

    </a>
    AI4Med
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Course Information
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Course Information
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_syllabus/index.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    None
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../chapter_preface/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Chapter 0. Introduction
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Chapter 0. Introduction
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Chapter 1. Basics of Coding
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Chapter 1. Basics of Coding
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_coding/index.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    None
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_coding/code_principle.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Principles
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_coding/coding_style.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Code in Style
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../chapter_ai/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Chapter 2. Coding with AI
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Chapter 2. Coding with AI
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_ai/ai_copilot/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AI Copilot
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_ai/prompt_engineering/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Prompt Engineering
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_ai/ai_tools/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AI Tools
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Chapter 3. Computing Workflow
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Chapter 3. Computing Workflow
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_workflow/index.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    None
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_workflow/computing_workflow.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Workflow
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_workflow/git.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Git and GitHub
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_workflow/make.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Make
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_workflow/venv.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Virtual Environment
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_workflow/R.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Reproducible R
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_workflow/docker.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Docker
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Chapter 4. Complexity analysis
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Chapter 4. Complexity analysis
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_computational_complexity/index.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    None
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_computational_complexity/time_complexity.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Time complexity
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_computational_complexity/space_complexity.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Space complexity
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Chapter 5. Data Structures
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Chapter 5. Data Structures
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_data_structures/index.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    None
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_data_structures/list.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Lists
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_data_structures/stack.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Stack
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_data_structures/queue.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Queue
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_data_structures/hash_map.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hash Table
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_data_structures/numpy_array.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    NumPy Arrays
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_data_structures/pandas_dataframe.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pandas DataFrame
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_data_structures/polars.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Polars
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_data_structures/multiprocess.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Multiprocessing
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Chapter 6. Discrete Algorithms
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            Chapter 6. Discrete Algorithms
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_algorithms/index.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    None
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_algorithms/climb_stairs.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Depth-first Search
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_algorithms/divide_n_conquer.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Divide and Conquer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_algorithms/bfs.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Breadth-first Search
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_algorithms/dynamic_programming.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dynamic Programming
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_algorithms/summary.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Summary
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Chapter 7. Numerical Linear Algebra
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            Chapter 7. Numerical Linear Algebra
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_linear_algebra/index.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    None
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_linear_algebra/basic_linear_algebra.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Linear Algebra Basics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_linear_algebra/numerical_criteria.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Numerical Criteria
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_linear_algebra/linear_equation.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Linear Equations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_linear_algebra/eigen.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Eigen-Decomposition
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_linear_algebra/sparse_matrix.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Sparse Matrices
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_linear_algebra/stochastic_matrix.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Randomized Methods
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_linear_algebra/gpu_matrix.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GPU for Matrices
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Chapter 8. Optimization
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_10" id="__nav_10_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            Chapter 8. Optimization
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../convexity/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Convexity
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rate_of_convergence/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Rate of Convergence
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pytorch_basics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PyTorch Basics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../gradient_descent/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Gradient Descent
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../agd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Accelerated Gradient Descent
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sgd/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Stochastic Gradient Descent
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../proximal_gradient_descent/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Proximal Gradient Descent
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mirror_descent/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mirror Descent
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../nesterov_smooth/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Nesterov's Smooth Method
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Duality and ADMM
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Duality and ADMM
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#composite-objective-function" class="md-nav__link">
    <span class="md-ellipsis">
      Composite Objective Function
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#duality" class="md-nav__link">
    <span class="md-ellipsis">
      Duality
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Duality">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-duality-of-lasso" class="md-nav__link">
    <span class="md-ellipsis">
      Example: Duality of Lasso
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#alternating-direction-method-of-multipliers-admm" class="md-nav__link">
    <span class="md-ellipsis">
      Alternating Direction Method of Multipliers (ADMM)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Alternating Direction Method of Multipliers (ADMM)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-fused-lasso" class="md-nav__link">
    <span class="md-ellipsis">
      Example: Fused Lasso
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-graphical-lasso" class="md-nav__link">
    <span class="md-ellipsis">
      Example: Graphical Lasso
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-consensus-optimization" class="md-nav__link">
    <span class="md-ellipsis">
      Example: Consensus Optimization
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../chapter_neural_networks/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Chapter 9. Neural Networks
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_11" id="__nav_11_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11">
            <span class="md-nav__icon md-icon"></span>
            Chapter 9. Neural Networks
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_neural_networks/nn/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Neural Networks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_neural_networks/regularization/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Regularization
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_neural_networks/cnn/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Convolutional Neural Networks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_neural_networks/resnet/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Residual Networks
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_neural_networks/fine_tuning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fine-tuning
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_neural_networks/computer_vision/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Computer Vision
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_neural_networks/dl_workflow/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Training Workflow
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_neural_networks/dl_gpu/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PyTorch for GPU
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_neural_networks/dl_tips/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Deep Learning Tips
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_neural_networks/pitfall/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PyTorch Pitfalls
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_12" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../chapter_language_model/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Chapter 10. Language Models
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_12" id="__nav_12_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_12_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_12">
            <span class="md-nav__icon md-icon"></span>
            Chapter 10. Language Models
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_language_model/wordvec/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Word Vectors
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_language_model/attention/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Attention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_language_model/transformer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Transformer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_language_model/hg_transformers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hugging Face
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_13" >
        
          
          <label class="md-nav__link" for="__nav_13" id="__nav_13_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Chapter 11. Reinforcement Learning
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_13_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_13">
            <span class="md-nav__icon md-icon"></span>
            Chapter 11. Reinforcement Learning
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_reinforcement_learning/index.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    None
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_reinforcement_learning/mdp.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Markov Decision Process
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_reinforcement_learning/policy_grad.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Policy Gradient
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_reinforcement_learning/ppo.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Proximal Policy Optimization
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_14" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../chapter_generative_model/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Chapter 12. Generative Models
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_14" id="__nav_14_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_14_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_14">
            <span class="md-nav__icon md-icon"></span>
            Chapter 12. Generative Models
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_generative_model/langevin_dynamics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Langevin Dynamics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_generative_model/ddpm/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Diffusion Models
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_generative_model/flow_match/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Flow Matching
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_15" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../chapter_appendix/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Appendix
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_15" id="__nav_15_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_15_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_15">
            <span class="md-nav__icon md-icon"></span>
            Appendix
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_appendix/installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_appendix/github/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Github Classroom
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_appendix/cluster/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Class Cluster
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_appendix/python_intro/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Python 101
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter_appendix/contribution/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contributing
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_16" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../chapter_reference/" class="md-nav__link ">
              
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9 3v15h3V3zm3 2 4 13 3-1-4-13zM5 5v13h3V5zM3 19v2h18v-2z"/></svg>
  
  <span class="md-ellipsis">
    References
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_16_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_16">
            <span class="md-nav__icon md-icon"></span>
            References
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#composite-objective-function" class="md-nav__link">
    <span class="md-ellipsis">
      Composite Objective Function
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#duality" class="md-nav__link">
    <span class="md-ellipsis">
      Duality
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Duality">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-duality-of-lasso" class="md-nav__link">
    <span class="md-ellipsis">
      Example: Duality of Lasso
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#alternating-direction-method-of-multipliers-admm" class="md-nav__link">
    <span class="md-ellipsis">
      Alternating Direction Method of Multipliers (ADMM)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Alternating Direction Method of Multipliers (ADMM)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#example-fused-lasso" class="md-nav__link">
    <span class="md-ellipsis">
      Example: Fused Lasso
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-graphical-lasso" class="md-nav__link">
    <span class="md-ellipsis">
      Example: Graphical Lasso
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#example-consensus-optimization" class="md-nav__link">
    <span class="md-ellipsis">
      Example: Consensus Optimization
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  <!-- Tags -->


<!-- Actions -->
<!-- Actions -->


  <!-- Edit button -->
  

  <!-- View button -->
  


<!-- Page content -->
<h1 id="duality-and-admm">Duality and ADMM<a class="headerlink" href="#duality-and-admm" title="Permanent link">&para;</a></h1>
<h2 id="composite-objective-function">Composite Objective Function<a class="headerlink" href="#composite-objective-function" title="Permanent link">&para;</a></h2>
<p>We have introduced proximal gradient descent to solve optimization problems of the form <span class="arithmatex">\(\min_x f(x) + g(x)\)</span>, where <span class="arithmatex">\(f\)</span> is smooth but <span class="arithmatex">\(g\)</span> is not differentiable. A key step in proximal gradient descent is solving the proximal operator:</p>
<div class="arithmatex">\[
{\rm prox}_g(x) = \arg\min_{z\in\mathbb{R}^d}\left\{\frac{1}{2} \|z-x\|_2^2 + g(z)\right\}
\]</div>
<p>For example, when <span class="arithmatex">\(g(x) = \lambda \|x\|_1\)</span>, the proximal operator is soft-thresholding. For the fused Lasso problem:</p>
<div class="arithmatex">\[
\min_{\beta} \|Y - X\beta\|_2^2 + \lambda \|D\beta\|_1
\]</div>
<p>where <span class="arithmatex">\(D\)</span> is some matrix representing the differential map, applying proximal gradient descent requires solving:</p>
<div class="arithmatex">\[
\arg\min_{z\in\mathbb{R}^d}\left\{\frac{1}{2} \|z-x\|_2^2 + \lambda \|Dz\|_1\right\}
\]</div>
<p>Unlike the <span class="arithmatex">\(\ell_1\)</span>-norm, this problem lacks a closed-form solution, making proximal gradient descent inefficient for fused Lasso.</p>
<p>We discuss solving composite objective functions. Generally, we are interested in the following composite optimization problem:</p>
<div class="arithmatex">\[
\min_{x,y} f(x) + g(y), \text{ s.t. } Ax + By = c
\]</div>
<p>for some convex <span class="arithmatex">\(f\)</span> and <span class="arithmatex">\(g\)</span>. The fused Lasso can be reduced to this form by letting <span class="arithmatex">\(f(\beta) = \|Y - X\beta\|_2^2\)</span>, <span class="arithmatex">\(g(y) = \lambda \|y\|_1\)</span>, so:</p>
<div class="arithmatex">\[
\min_{\beta} \|Y - X\beta\|_2^2 + \lambda \|D\beta\|_1 \Longleftrightarrow \min_{\beta,y} f(\beta) + g(y), \text{ s.t. } D\beta - y = 0
\]</div>
<p>Another example is basis pursuit:</p>
<div class="arithmatex">\[
\min_{\beta} \|\beta\|_1 \text{ s.t. } X\beta - Y = 0
\]</div>
<h2 id="duality">Duality<a class="headerlink" href="#duality" title="Permanent link">&para;</a></h2>
<p>To solve the composite optimization problem, we start by reviewing duality in optimization. We define the Lagrange multiplier function of the problem as:</p>
<div class="arithmatex">\[
L(x,y, \lambda) = f(x) + g(y) + \lambda^\top(Ax + By -c)
\]</div>
<p>This allows us to convert the <strong>primal problem</strong> to the <strong>dual problem</strong>:</p>
<div class="arithmatex">\[
\max_{\lambda} h(\lambda), \text{ where } h(\lambda) = \min_{x,y}L(x,y, \lambda)
\]</div>
<p>Duality is crucial in optimization. The following theorem implies we can solve the primal problem via the dual problem.</p>
<p><strong>Theorem</strong> (Strong Duality): Given convex functions <span class="arithmatex">\(f,g\)</span>, the primal problem has the solution:</p>
<div class="arithmatex">\[
(x^*, y^*) = \arg\min_{x,y} f(x) + g(y), \text{ s.t. } Ax + By = c
\]</div>
<p>Consider the dual problem <span class="arithmatex">\(\lambda^* = \arg\max_{\lambda} h(\lambda)\)</span>, where <span class="arithmatex">\(h(\lambda) = \min_{x,y}L(x,y, \lambda)\)</span>. We can solve <span class="arithmatex">\((x^*, y^*)\)</span> via:</p>
<div class="arithmatex">\[
(x^*, y^*) = \arg\min_{x,y} L(x,y, \lambda^*)
\]</div>
<p>As <span class="arithmatex">\(L(x,y, \lambda^*)\)</span> is decomposable, we further have:</p>
<div class="arithmatex">\[
x^* = \arg\min_x f(x) + \lambda^{*\top} Ax \text{ and } y^* = \arg\min_y g(y) + \lambda^{*\top} By
\]</div>
<p>The strong duality property is useful for converting a linear constraint problem to an unconstrained dual problem. The following example shows how to find the dual problem of Lasso.</p>
<h3 id="example-duality-of-lasso">Example: Duality of Lasso<a class="headerlink" href="#example-duality-of-lasso" title="Permanent link">&para;</a></h3>
<p>As Lasso is an unconstrained problem, we first convert it to the standard form:</p>
<div class="arithmatex">\[
\min_\beta \frac{1}{2}\|Y - X\beta\|_2^2 + \lambda\|\beta\|_1 \iff \min_{\beta, z} \frac{1}{2}\|z\|_2^2 + \lambda\|\beta\|_1, \text{ s.t. } Y - X\beta = z
\]</div>
<p>The Lagrange function is:</p>
<div class="arithmatex">\[
L(\beta, z, \mu) = \frac{1}{2}\|z\|^2_2 + \lambda\|\beta\|_1 + \mu^\top (Y - X\beta -z)
\]</div>
<p>Notice that <span class="arithmatex">\(L(\beta, z, \mu)\)</span> is decomposable:</p>
<div class="arithmatex">\[
\min_{\beta,z}L(\beta, z, \mu) = \min_\beta \left\{\lambda\|\beta\|_1 - \mu^\top X\beta \right\}+ \min_z \left\{\frac{1}{2}\|z\|^2_2 - \mu^\top z\right\} + \mu^\top Y
\]</div>
<p>The second problem is quadratic, and we have:</p>
<div class="arithmatex">\[
z^* = \arg\min_z \left\{\frac{1}{2}\|z\|^2_2 - \mu^\top z \right\} \implies z^* - \mu = 0
\]</div>
<p>Applying the first-order optimality condition to the first problem, we get:</p>
<div class="arithmatex">\[
\beta^* = \arg\min_\beta \left\{\lambda\|\beta\|_1 - \mu^\top X\beta \right\} \implies 0 = -X^\top \mu + \lambda g, \text{ for some } g \in \partial \|\beta^*\|_1
\]</div>
<p>As <span class="arithmatex">\(\|g\|_\infty \le 1\)</span>, the equality <span class="arithmatex">\(0 = -X^\top \mu + \lambda g\)</span> has a finite solution only if <span class="arithmatex">\(\lambda \geq \|X^\top \mu\|_\infty\)</span>. Moreover, if <span class="arithmatex">\(\lambda \geq \|X^\top \mu\|_\infty\)</span>, multiplying <span class="arithmatex">\(\beta^*\)</span> on both sides of <span class="arithmatex">\(0 = -X^\top \mu + \lambda g\)</span> gives:</p>
<div class="arithmatex">\[
0 = -\beta^{*\top}X^\top \mu + \lambda \|\beta^*\|_1
\]</div>
<p>Therefore, we have:</p>
<div class="arithmatex">\[
\min_\beta \left\{\lambda\|\beta\|_1 - \mu^\top X\beta \right\} = \begin{cases} 0, &amp;\text{if } \lambda \geq \|X^\top \mu\|_\infty; \\ -\infty, &amp;\text{if } \lambda &lt; \|X^\top \mu\|_\infty. \end{cases}
\]</div>
<p>Combining the results, the dual problem becomes:</p>
<div class="arithmatex">\[
\max_{\lambda} \min_{\beta,z}L(\beta, z, \mu) = \max_{\lambda}\left\{-\frac{1}{2}\|\mu\|_2^2 + \mu^\top Y\right\} \text{ s.t. } \lambda \geq \|X^\top \mu\|_\infty
\]</div>
<p>Therefore, the dual problem of Lasso is:</p>
<div class="arithmatex">\[
\max_\mu L(\beta^*, z^*, \mu) = \max_\mu -\frac{1}{2}\|\mu\|_2^2 + \mu^\top Y \text{ s.t. } \|X^\top \mu\|_\infty \le \lambda
\]</div>
<p>This is equivalent to:</p>
<div class="arithmatex">\[
\text{**Duality of Lasso**}: \min_{\mu} \|Y - \mu\|_2^2, \text{ s.t. } \|X^\top \mu\|_\infty \le \lambda
\]</div>
<p><a class="glightbox" href="../opt.assets/duallasso1-1.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Duality of Lasso" src="../opt.assets/duallasso1-1.png" /></a>
<a class="glightbox" href="../opt.assets/duallasso2-1.png" data-type="image" data-width="100%" data-height="auto" data-desc-position="bottom"><img alt="Duality of Lasso" src="../opt.assets/duallasso2-1.png" /></a></p>
<p>By the duality, the dual variable <span class="arithmatex">\(\mu^* = z^* = Y - X\beta^*\)</span> is the residual. This gives a new geometric insight into Lasso, illustrating that Lasso is a projection, similar to OLS.</p>
<h2 id="alternating-direction-method-of-multipliers-admm">Alternating Direction Method of Multipliers (ADMM)<a class="headerlink" href="#alternating-direction-method-of-multipliers-admm" title="Permanent link">&para;</a></h2>
<p>Consider an equivalent form of the problem by adding a quadratic term:</p>
<div class="arithmatex">\[
\left\{\begin{aligned}&amp;\min_{x,y} f(x) + g(y)\\&amp;\text{ s.t. } Ax + By = c,\end{aligned}\right\} \Longleftrightarrow \left\{\begin{aligned}&amp;\min_{x,y}f(x) + g(y) + \frac{\rho}{2}\|Ax + By -c\|_2^2\\&amp;\text{ s.t. }Ax + By = c.\end{aligned}\right\}
\]</div>
<p>We introduce the <strong>augmented Lagrangian</strong>:</p>
<div class="arithmatex">\[
L_{\rho} (x,y,\lambda) = f(x) + g(y) + \lambda^\top (Ax + By -c) +\frac{\rho}{2}\|Ax + By -c\|_2^2
\]</div>
<p>To solve the dual problem <span class="arithmatex">\(\max_\lambda \min_{x,y} L_{\rho} (x,y,\lambda)\)</span>, we propose updating the primal and dual variables alternately:</p>
<p><strong>Primal step</strong>:</p>
<div class="arithmatex">\[
\begin{cases}x_{t+1}= \arg\min_x L_{\rho}(x, y_t, \lambda_t);\\y_{t+1}= \arg\min_y L_{\rho}(x_{t+1}, y, \lambda_t);\end{cases}
\]</div>
<p><strong>Dual step</strong>:</p>
<div class="arithmatex">\[
\lambda_{t+1}= \arg\max_\lambda L_{\rho}(x_{t+1}, y_{t+1}, \lambda) -\frac{1}{2\rho}\|\lambda - \lambda_t\|_2^2
\]</div>
<p>We add a proximal term in the dual step because the augmented Lagrangian <span class="arithmatex">\(L_{\rho}(x_{t+1}, y_{t+1}, \lambda)\)</span> is linear with respect to <span class="arithmatex">\(\lambda\)</span>, making <span class="arithmatex">\(\max_{\lambda} L_{\rho}(x_{t+1}, y_{t+1}, \lambda) = \infty\)</span>. The proximal term prevents <span class="arithmatex">\(\lambda_{t+1}\)</span> from deviating too much from <span class="arithmatex">\(\lambda_t\)</span>.</p>
<p>Plugging the augmented Lagrangian into the primal and dual steps, we have the following algorithm.</p>
<div class="admonition abstract">
<p class="admonition-title">Alternating Direction Method of Multipliers (ADMM)</p>
<div class="arithmatex">\[
\begin{align*}x_{t+1} &amp;= \arg\min_x f(x) + \frac{\rho}{2} \|Ax + By_t - c + \lambda_t/\rho\|_2^2\\y_{t+1} &amp;= \arg\min_y g(x) + \frac{\rho}{2} \|Ax_{t+1} + By - c + \lambda_t/\rho\|_2^2\\\lambda_{t+1} &amp;= \lambda_t + \rho(Ax_{t+1} + By_{t+1} - c)\end{align*}
\]</div>
</div>
<p>If <span class="arithmatex">\(f\)</span> and <span class="arithmatex">\(g\)</span> are closed convex functions, the ADMM algorithm converges.</p>
<div class="admonition note">
<p class="admonition-title">ADMM not first-order method</p>
<p>ADMM is not a first-order method. The sub-problem in the primal step use the functions <span class="arithmatex">\(f\)</span> and <span class="arithmatex">\(g\)</span> instead of just their gradients like the proximal gradient descent. So ADMM may converge faster than first-order methods in terms of the number of iterations, but the computational cost per iteration might be higher.</p>
</div>
<h3 id="example-fused-lasso">Example: Fused Lasso<a class="headerlink" href="#example-fused-lasso" title="Permanent link">&para;</a></h3>
<p>Applying ADMM to the fused Lasso:</p>
<div class="arithmatex">\[
\min_{\beta } \frac{1}{2}\|Y - X\beta\|_2^2 + \lambda \|D\beta\|_1 \iff \min_{\beta,z } \frac{1}{2}\|Y - X\beta\|_2^2 + \lambda \|z\|_1 \text{ s.t. } D\beta - z=0
\]</div>
<p>The updating rule is:</p>
<div class="arithmatex">\[
\begin{align*}\beta_{t+1}&amp;= \arg\min_\beta \frac{1}{2}\|Y - X\beta\|_2^2 + \frac{\rho}{2}\|D\beta -z_t + \lambda_t/\rho\|_2^2\\z_{t+1}&amp;= \arg\min_z \lambda\|z\|_1 + \frac{\rho}{2}\|D\beta_{t+1} -z + \lambda_t/\rho\|_2^2\\\lambda_{t+1} &amp;= \lambda_t + \rho(D\beta_{t+1} - z_{t+1})\end{align*}
\]</div>
<p>This yields the algorithm:</p>
<div class="arithmatex">\[
\begin{align*}\beta_{t+1}&amp;= (X^\top X + \rho D^\top D)^{-1} (X^\top Y + \rho D^\top z_{t} - D^\top\lambda_{t})\\z_{t+1}&amp;= \text{SoftThreshold}(D\beta_{t+1}+ \lambda_t/\rho, \lambda/\rho)\\\lambda_{t+1} &amp;= \lambda_t + \rho(D\beta_{t+1} - z_{t+1})\end{align*}
\]</div>
<p>When <span class="arithmatex">\(D = I\)</span>, the algorithm reduces to ADMM for Lasso. Unlike FISTA, ADMM involves matrix inversion, which may be time-consuming when <span class="arithmatex">\(d\)</span> is large.</p>
<p>Here is the implementation of ADMM for fused Lasso in PyTorch. Notice we can implement the tips in <a href="../chapter_linear_algebra/linear_equation.md#tips-for-solving-linear-equations">Linear Algebra</a> to pre-compute the Cholesky decomposition of the matrix <span class="arithmatex">\((X^\top X + \rho D^\top D)\)</span> to make it more efficient.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="c1"># Soft-thresholding function</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="k">def</span><span class="w"> </span><span class="nf">soft_thresholding</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">threshold</span><span class="p">):</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>    <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">clamp</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="n">threshold</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="c1"># Define problem parameters</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="n">torch</span><span class="o">.</span><span class="n">manual_seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="n">n</span><span class="p">,</span> <span class="n">d</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">5</span>  <span class="c1"># Number of samples (n) and features (d)</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="n">X</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>  <span class="c1"># Design matrix</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="n">Y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>  <span class="c1"># Response vector</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="c1"># Define difference matrix D (for fused lasso)</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="n">D</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">-</span> <span class="n">torch</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># First-order difference matrix</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="c1"># Initialize variables</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="n">beta</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>  <span class="c1"># Coefficients</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="n">z</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">d</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># Auxiliary variable</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="n">lam</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">d</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># Lagrange multiplier</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="c1"># ADMM parameters</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a><span class="n">lambda_</span> <span class="o">=</span> <span class="mf">0.1</span>  <span class="c1"># Regularization parameter</span>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a><span class="n">rho</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># ADMM penalty parameter</span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a><span class="n">num_iters</span> <span class="o">=</span> <span class="mi">100</span>  <span class="c1"># Number of iterations</span>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a><span class="c1"># Compute Cholesky decomposition of (X^T X + rho D^T D)</span>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a><span class="n">XtX</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">X</span>
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a><span class="n">DtD</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">D</span>
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a><span class="n">A</span> <span class="o">=</span> <span class="n">XtX</span> <span class="o">+</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">DtD</span>  <span class="c1"># Regularized system matrix</span>
<a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a>
<a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a><span class="c1"># Cholesky decomposition (more stable than direct inversion)</span>
<a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a><span class="n">L</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">cholesky</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>  <span class="c1"># Compute Cholesky factor L</span>
<a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a>
<a id="__codelineno-0-34" name="__codelineno-0-34" href="#__codelineno-0-34"></a><span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_iters</span><span class="p">):</span>
<a id="__codelineno-0-35" name="__codelineno-0-35" href="#__codelineno-0-35"></a>    <span class="c1"># Solve for beta using Cholesky decomposition</span>
<a id="__codelineno-0-36" name="__codelineno-0-36" href="#__codelineno-0-36"></a>    <span class="n">b_rhs</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">Y</span> <span class="o">+</span> <span class="n">rho</span> <span class="o">*</span> <span class="n">D</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">z</span> <span class="o">-</span> <span class="n">D</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">lam</span>  <span class="c1"># Right-hand side</span>
<a id="__codelineno-0-37" name="__codelineno-0-37" href="#__codelineno-0-37"></a>    <span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve_triangular</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">b_rhs</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># Forward substitution</span>
<a id="__codelineno-0-38" name="__codelineno-0-38" href="#__codelineno-0-38"></a>    <span class="n">beta</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve_triangular</span><span class="p">(</span><span class="n">L</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># Backward substitution</span>
<a id="__codelineno-0-39" name="__codelineno-0-39" href="#__codelineno-0-39"></a>
<a id="__codelineno-0-40" name="__codelineno-0-40" href="#__codelineno-0-40"></a>    <span class="c1"># Update z using soft-thresholding</span>
<a id="__codelineno-0-41" name="__codelineno-0-41" href="#__codelineno-0-41"></a>    <span class="n">z</span> <span class="o">=</span> <span class="n">soft_thresholding</span><span class="p">(</span><span class="n">D</span> <span class="o">@</span> <span class="n">beta</span> <span class="o">+</span> <span class="n">lam</span> <span class="o">/</span> <span class="n">rho</span><span class="p">,</span> <span class="n">lambda_</span> <span class="o">/</span> <span class="n">rho</span><span class="p">)</span>
<a id="__codelineno-0-42" name="__codelineno-0-42" href="#__codelineno-0-42"></a>
<a id="__codelineno-0-43" name="__codelineno-0-43" href="#__codelineno-0-43"></a>    <span class="c1"># Update lambda (dual variable)</span>
<a id="__codelineno-0-44" name="__codelineno-0-44" href="#__codelineno-0-44"></a>    <span class="n">lam</span> <span class="o">+=</span> <span class="n">rho</span> <span class="o">*</span> <span class="p">(</span><span class="n">D</span> <span class="o">@</span> <span class="n">beta</span> <span class="o">-</span> <span class="n">z</span><span class="p">)</span>
</code></pre></div>
<p>When <span class="arithmatex">\(d\)</span> is large, we can further improve the efficiency by using the <a href="../chapter_linear_algebra/linear_equation.md#tips-for-solving-linear-equations">Woodbury matrix identity</a> to solve the linear system 
$$
(X^TX + ρD<sup -1="-1">TD)</sup> = (ρD<sup -1="-1">TD)</sup> - (ρD<sup -1="-1">TD)</sup>X^T(I_n + X(ρD<sup -1="-1">TD)</sup>X<sup -1="-1">T)</sup>X(ρD<sup -1="-1">TD)</sup>
$$
The computation will be much more efficient, especially when for the Lasso case <span class="arithmatex">\(D = I\)</span>.</p>
<h3 id="example-graphical-lasso">Example: Graphical Lasso<a class="headerlink" href="#example-graphical-lasso" title="Permanent link">&para;</a></h3>
<p>Given i.i.d. samples <span class="arithmatex">\(X_1, \ldots, X_n \sim N(0, \Sigma)\)</span>, we estimate the precision matrix <span class="arithmatex">\(\Theta = \Sigma^{-1}\)</span> via graphical Lasso:</p>
<div class="arithmatex">\[
\begin{align*}&amp;\min_{\Theta } -\log \det \Theta + \text{tr}{(\Theta^\top \hat{\Sigma})} + \lambda\|\Theta\|_{1,1} \\\Updownarrow\\&amp;\min_{\Theta, \Psi } -\log \det \Theta + \text{tr}{(\Theta^\top \hat{\Sigma})} + \lambda\|\Psi\|_{1,1} \text{ s.t. } \Theta = \Psi\end{align*}
\]</div>
<p>Applying ADMM, we get:</p>
<div class="arithmatex">\[
\begin{align*}\Theta_{t+1}&amp;= \arg\min_\Theta -\log \det \Theta + \text{tr}{(\Theta^\top \hat{\Sigma})} + \frac{\rho}{2}\|\Theta - \Psi_t+ \Lambda_t/{\rho}\|_{\rm F}^2\\\Psi_{t+1}&amp;= \arg\min_\Psi\lambda\|\Psi\|_{1,1} + \frac{\rho}{2}\|\Theta_{t+1} - \Psi+ \Lambda_t/{\rho}\|_{\rm F}^2\\\Lambda_{t+1}&amp;= \Lambda_t + \rho(\Theta_{t+1} - \Psi_{t+1} )\end{align*}
\]</div>
<p>where the Frobenius norm <span class="arithmatex">\(\|A\|_{\rm F}^2 = \sum_{jk}A_{jk}^2\)</span>. This simplifies to:</p>
<div class="arithmatex">\[
\begin{align*}\Theta_{t+1}&amp;= \mathcal{F}_{\rho}(\Psi_t- \Lambda_t/{\rho} - \widehat \Sigma/{\rho} )\\\Psi_{t+1}&amp;= \text{SoftThreshold}(\Theta_{t+1}+ \Lambda_t/{\rho}, \lambda/\rho)\\\Lambda_{t+1}&amp;= \Lambda_t + \rho(\Theta_{t+1} - \Psi_{t+1} )\end{align*}
\]</div>
<p>where for the spectral decomposition <span class="arithmatex">\(X = UDU^\top\)</span>, <span class="arithmatex">\(\mathcal{F}_{\rho}(X) = U{\rm diag}\{\lambda_i + \sqrt{\lambda_i + 4/\rho}\}U^\top\)</span>.</p>
<h3 id="example-consensus-optimization">Example: Consensus Optimization<a class="headerlink" href="#example-consensus-optimization" title="Permanent link">&para;</a></h3>
<p>We design a divide-and-conquer ADMM for Lasso for massive data when <span class="arithmatex">\(n\)</span> is ultra-large. The Lasso:</p>
<div class="arithmatex">\[
\min_{\beta } \sum_{i=1}^n (Y_i - X_i\beta)^2 + \lambda\|\beta\|_1
\]</div>
<p>can be formulated as the general block separable form:</p>
<div class="arithmatex">\[
\min_x \sum_{i=1}^n f_i(x) \iff \min_{x_i,z}\sum_{i=1}^n f_i(x) \text{ s.t. } x_i = z \text{ for all } i = 1, \ldots, n
\]</div>
<p>Applying ADMM, we get:</p>
<div class="admonition abstract">
<p class="admonition-title">ADMM for Consensus Optimization</p>
<div class="arithmatex">\[
\begin{align*}
\text{Divide: } x_i^{t+1}&amp;= \arg\min_{x_i} f_i(x_i) + \frac{\rho}{2}\|x_i - z^t + \lambda_i^t/{\rho}\|_2^2, \forall i = 1, \ldots, n\\
\text{Gather: } z^{t+1} &amp;=\frac{1}{n}\sum_{i=1}^n (x_i^{t+1}+ \lambda_i^t/{\rho})\\
\text{Broadcast: } \lambda_i^{t+1} &amp; = \lambda_i^t + \rho(x_i^{t+1}- z^{t+1} ), \forall i = 1, \ldots, n
\end{align*}
\]</div>
</div>
<p>In the first step, we update each <span class="arithmatex">\(x_i^{t+1}\)</span> in parallel, then gather all local iterates, and finally broadcast the updated dual variables back to each core. </p>

<!-- Source file information -->


<!-- Was this page helpful? -->




<!-- Previous and next pages link -->
<nav
class="md-footer__inner md-grid"
aria-label="Footer"

>

<!-- Link to previous page -->

  
  <a
    href="../nesterov_smooth/"
    class="md-footer__link md-footer__link--prev"
    aria-label="Previous: Nesterov&#39;s Smooth Method"
    rel="prev"
  >
    <div class="md-footer__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
    </div>
    <div class="md-footer__title">
      <span class="md-footer__direction">
        Previous
      </span>
      <div class="md-ellipsis">
        Nesterov's Smooth Method
      </div>
    </div>
  </a>


<!-- Link to next page -->

  
  <a
    href="../../chapter_neural_networks/"
    class="md-footer__link md-footer__link--next"
    aria-label="Next: Neural Networks"
    rel="next"
  >
    <div class="md-footer__title">
      <span class="md-footer__direction">
        Next
      </span>
      <div class="md-ellipsis">
        Neural Networks
      </div>
    </div>
    <div class="md-footer__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
    </div>
  </a>

</nav>

<!-- Comment system -->

                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../nesterov_smooth/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Nesterov&#39;s Smooth Method">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Nesterov's Smooth Method
              </div>
            </div>
          </a>
        
        
          
          <a href="../../chapter_neural_networks/" class="md-footer__link md-footer__link--next" aria-label="Next: Neural Networks">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Neural Networks
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Junwei Lu, Department of Biostatistics, Harvard T.H. Chan School of Public Health.
    </div>
  
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/junwei-lu/" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://junwei-lu.github.io/" target="_blank" rel="noopener" title="junwei-lu.github.io" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M392.8 1.2c-17-4.9-34.7 5-39.6 22l-128 448c-4.9 17 5 34.7 22 39.6s34.7-5 39.6-22l128-448c4.9-17-5-34.7-22-39.6m80.6 120.1c-12.5 12.5-12.5 32.8 0 45.3l89.3 89.4-89.4 89.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l112-112c12.5-12.5 12.5-32.8 0-45.3l-112-112c-12.5-12.5-32.8-12.5-45.3 0zm-306.7 0c-12.5-12.5-32.8-12.5-45.3 0l-112 112c-12.5 12.5-12.5 32.8 0 45.3l112 112c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L77.3 256l89.4-89.4c12.5-12.5 12.5-32.8 0-45.3"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["announce.dismiss", "content.code.annotate", "content.code.copy", "content.tabs.link", "content.tooltips", "navigation.indexes", "navigation.top", "navigation.footer", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.83f73b43.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.min.js"></script>
      
    
  <script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": false, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "none"});})</script></body>
</html>